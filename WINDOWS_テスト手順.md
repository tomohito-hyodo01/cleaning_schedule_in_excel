# Windows環境での動作確認手順

## 🎯 概要

このドキュメントでは、macOSで開発したアプリケーションをWindows環境で動作確認する手順を説明します。

---

## 📋 事前準備

### 必要なもの

- ✅ Windows 10 または Windows 11
- ✅ インターネット接続
- ✅ プロジェクトフォルダ一式
- ✅ Claude APIキー（既に取得済み）

### Windows環境へのファイル転送

以下のいずれかの方法でプロジェクトフォルダをWindows環境に転送してください：

#### 方法1: USBメモリ
```
1. macOSでプロジェクトフォルダ全体をUSBメモリにコピー
2. Windows PCに接続
3. 任意のフォルダにコピー（例: C:\Projects\清掃スケジュール対応）
```

#### 方法2: クラウドストレージ
```
1. Dropbox/Google Drive/OneDrive等にアップロード
2. Windows PCでダウンロード
```

#### 方法3: ネットワーク共有
```
1. macOSで共有設定
2. Windowsからネットワークドライブでアクセス
3. フォルダをコピー
```

---

## 🚀 Windows環境でのテスト手順

### ステップ1: Pythonのインストール確認

1. **コマンドプロンプトを開く**
   - Windowsキー + R
   - `cmd` と入力して Enter

2. **Pythonのバージョン確認**
   ```cmd
   python --version
   ```

3. **結果の確認**
   - `Python 3.9.x` 以上が表示されればOK
   - 表示されない場合は、Pythonをインストール

#### Pythonのインストール（必要な場合）

1. https://www.python.org/downloads/ にアクセス
2. 「Download Python 3.12.x」をクリック
3. ダウンロードしたインストーラーを実行
4. **重要**: 「Add Python to PATH」に必ずチェック ✅
5. 「Install Now」をクリック
6. インストール完了後、コマンドプロンプトを再起動

---

### ステップ2: プロジェクトフォルダに移動

```cmd
# 例: Cドライブの Projects フォルダにコピーした場合
cd C:\Projects\清掃スケジュール対応

# または、エクスプローラーでフォルダを開いて、アドレスバーに「cmd」と入力してEnter
```

---

### ステップ3: 依存ライブラリのインストール

#### 方法A: setup.bat を使う（推奨）

```cmd
setup.bat
```

実行すると自動的に必要なライブラリがインストールされます。

#### 方法B: 手動でインストール

```cmd
pip install -r requirements.txt
```

#### インストール確認

エラーが表示されず、以下のようなメッセージが出ればOK：

```
Successfully installed customtkinter-5.2.1 Pillow-10.1.0 anthropic-0.39.0 openpyxl-3.1.2 python-dotenv-1.0.0
```

---

### ステップ4: アプリケーションの起動

#### 方法A: run.bat を使う（推奨）

```cmd
run.bat
```

#### 方法B: 直接Pythonで実行

```cmd
python main.py
```

---

### ステップ5: 動作確認

アプリが起動したら、以下の項目を順番に確認してください：

#### ✅ チェック1: アプリ起動確認

- [ ] ウィンドウが正常に表示される
- [ ] タイトル「清掃スケジュール Excel変換ツール」が表示される
- [ ] ボタンが正しく配置されている

#### ✅ チェック2: APIキー設定

1. 「⚙️ 設定」ボタンをクリック
2. 設定ダイアログが開くことを確認
3. APIキー入力欄にClaude APIキーを入力：
   ```
   your-claude-api-key-here
   ```
4. 「保存」ボタンをクリック
5. 「設定を保存しました」メッセージが表示される

確認項目:
- [ ] 設定ダイアログが開く
- [ ] APIキーが入力できる
- [ ] 保存が成功する
- [ ] ダイアログが閉じる

#### ✅ チェック3: 画像選択

1. 「📁 画像ファイルを選択」ボタンをクリック
2. ファイル選択ダイアログが開く
3. `schedule_image\清掃スケジュール.jpg` を選択
4. 「開く」をクリック

確認項目:
- [ ] ファイル選択ダイアログが開く
- [ ] 画像ファイルが選択できる
- [ ] 画像のプレビューが表示される
- [ ] ファイル名が表示される
- [ ] 「Excel変換開始」ボタンが有効になる

#### ✅ チェック4: Excel変換実行

1. 「🚀 Excel変換開始」ボタンをクリック
2. 進行状況を確認

確認項目:
- [ ] プログレスバーが動く
- [ ] ステータスメッセージが更新される
  - 「画像を読み込んでいます...」
  - 「Claude APIで解析中...」
  - 「Excelファイルを生成中...」
  - 「完了しました！」
- [ ] 処理が10-30秒程度で完了する

#### ✅ チェック5: Excel ファイル確認

1. 「変換完了」ダイアログが表示される
2. 「フォルダを開きますか？」と表示される
3. 「OK」をクリック
4. デスクトップフォルダが開く
5. `清掃スケジュール_変換結果.xlsx` が作成されている

確認項目:
- [ ] 完了ダイアログが表示される
- [ ] デスクトップフォルダが開く
- [ ] Excel ファイルが生成されている

#### ✅ チェック6: Excel ファイルの内容確認

1. 生成された Excel ファイルをダブルクリック
2. Excel または互換ソフトで開く

確認項目:
- [ ] ファイルが正常に開く
- [ ] 表のデータが含まれている
- [ ] レイアウトが適切に再現されている
- [ ] 文字化けがない

---

## 🔧 トラブルシューティング

### エラー1: 「python は、内部コマンドまたは外部コマンド...として認識されていません」

**原因**: Python がインストールされていない、またはPATHが通っていない

**解決方法**:
1. Python を再インストール
2. インストール時に「Add Python to PATH」にチェック
3. コマンドプロンプトを再起動

---

### エラー2: 「No module named 'customtkinter'」

**原因**: 依存ライブラリがインストールされていない

**解決方法**:
```cmd
pip install -r requirements.txt
```

---

### エラー3: 「APIキーが無効です」

**原因**: APIキーが正しく設定されていない

**解決方法**:
1. 設定ダイアログを開く
2. APIキーを再入力（コピー＆ペースト推奨）
3. `sk-ant-api03-` で始まることを確認

---

### エラー4: 「Claude API解析エラー」

**原因**: インターネット接続の問題、またはAPIの問題

**解決方法**:
1. インターネット接続を確認
2. https://console.anthropic.com/ でAPIキーの状態を確認
3. API利用制限に達していないか確認
4. しばらく待ってから再試行

---

### エラー5: アプリが起動しない

**原因**: ライブラリの依存関係の問題

**解決方法**:
```cmd
# すべてのライブラリを再インストール
pip uninstall -y customtkinter Pillow anthropic openpyxl python-dotenv
pip install -r requirements.txt
```

---

### エラー6: 画像が表示されない

**原因**: Pillow ライブラリの問題

**解決方法**:
```cmd
pip install --upgrade Pillow
```

---

## 📊 動作確認チェックリスト

すべて完了したらチェック ✅

### 基本動作
- [ ] アプリが起動する
- [ ] ウィンドウが正常に表示される
- [ ] すべてのボタンが表示される

### 設定機能
- [ ] 設定ダイアログが開く
- [ ] APIキーが設定できる
- [ ] 設定が保存される

### 画像選択機能
- [ ] ファイルダイアログが開く
- [ ] 画像が選択できる
- [ ] プレビューが表示される
- [ ] ファイル名が表示される

### 変換機能
- [ ] 変換ボタンが有効になる
- [ ] プログレスバーが動作する
- [ ] ステータスが更新される
- [ ] Claude API が正常に応答する
- [ ] 処理が完了する

### Excel生成
- [ ] Excel ファイルが作成される
- [ ] デスクトップに保存される
- [ ] フォルダが自動で開く
- [ ] Excel ファイルが開ける
- [ ] データが正しく表示される

### エラーハンドリング
- [ ] APIキー未設定時に警告が出る
- [ ] 画像未選択時にエラーメッセージ
- [ ] 不正な画像でエラー表示

---

## 🎯 次のステップ: 実行ファイル版のビルド

基本動作確認が完了したら、実行ファイル版をビルドできます。

### ビルド手順

```cmd
# 方法A: build.bat を使う（推奨）
build.bat

# 方法B: 手動でビルド
pip install pyinstaller
pyinstaller --onefile --windowed --name CleaningSchedule main.py
```

### ビルド結果の確認

```cmd
# 実行ファイルの場所
dir dist

# 実行ファイルを起動してテスト
dist\CleaningSchedule.exe
```

### 実行ファイル版の動作確認

上記の「動作確認チェックリスト」を実行ファイル版でも実施してください。

---

## 📝 動作確認レポート（テンプレート）

```
【動作確認レポート】

日時: 2025年10月20日
環境: Windows 11 (またはWindows 10)
Pythonバージョン: 3.12.x

【基本動作】
✅ アプリ起動: OK
✅ 設定機能: OK
✅ 画像選択: OK
✅ 変換機能: OK
✅ Excel生成: OK

【問題点】
なし（または、発生した問題を記載）

【備考】
（気づいた点があれば記載）
```

---

## 💡 ヒント

### コマンドプロンプトの便利な使い方

1. **フォルダから直接起動**
   - エクスプローラーでプロジェクトフォルダを開く
   - アドレスバーをクリック
   - `cmd` と入力してEnter
   - 自動的にそのフォルダでコマンドプロンプトが開く

2. **コマンド履歴**
   - ↑キーで前のコマンドを呼び出せる
   - 同じコマンドを何度も実行する場合に便利

3. **コピー＆ペースト**
   - 右クリックでペーストできる
   - APIキー等の長い文字列入力に便利

---

## 🎊 動作確認完了後

すべての動作確認が完了したら：

1. **実行ファイル版をビルド**
   ```cmd
   build.bat
   ```

2. **配布パッケージを作成**
   ```
   CleaningSchedule_配布用/
   ├── CleaningSchedule.exe
   ├── 使い方.txt
   └── サンプル画像/
   ```

3. **試作品として配布**
   - Windowsユーザーに.exeファイルを配布
   - 使い方ガイドも一緒に配布

---

## ✅ まとめ

### 動作確認の流れ

```
1. Pythonインストール確認
   ↓
2. プロジェクトフォルダに移動
   ↓
3. setup.bat 実行
   ↓
4. run.bat でアプリ起動
   ↓
5. 動作確認チェックリスト実施
   ↓
6. 問題なければビルド
   ↓
7. 実行ファイル版をテスト
   ↓
8. 配布準備完了！
```

ご質問やトラブルがあればお気軽にお聞きください！

